<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quicky get daily data • spanishoddata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="quick-get_files/libs/quarto-html/popper.min.js"></script><script src="quick-get_files/libs/quarto-html/tippy.umd.min.js"></script><link href="quick-get_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="quick-get_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quicky get daily data">
<meta property="og:image" content="https://rOpenSpain.github.io/spanishoddata/reference/figures/card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@rOpenSpain">
<meta name="twitter:site" content="@rOpenSpain">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet">
<!-- rogtemplate style sheet --><link href="../BS5/rostemplate.min.css" rel="stylesheet">
</head>
<body>
  <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


  <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand me-2" href="../index.html">
      <img src="../apple-touch-icon.png" alt="spanishoddata logo" height="40" class="d-inline-block me-1">spanishoddata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Codebooks</h6></li>
    <li><a class="dropdown-item" href="../articles/v1-2020-2021-mitma-data-codebook.html">Codebook and cookbook for v1 (2020-2021) Spanish mobility data</a></li>
    <li><a class="dropdown-item" href="../articles/v2-2022-onwards-mitma-data-codebook.html">Codebook and cookbook for v2 (2022 onwards) Spanish mobility data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Get/convert</h6></li>
    <li><a class="dropdown-item" href="../articles/quick-get.html">Quicky get daily data</a></li>
    <li><a class="dropdown-item" href="../articles/convert.html">Download and convert mobility datasets</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualise</h6></li>
    <li><a class="dropdown-item" href="../articles/flowmaps-static.html">Making static flow maps</a></li>
    <li><a class="dropdown-item" href="../articles/flowmaps-interactive.html">Making interactive flow maps</a></li>
    <li><a class="dropdown-item" href="../articles/disaggregation.html">OD data disaggregation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.ekotov.pro/agit-2025-spanishoddata/">Analysing massive open human mobility data using spanishoddata, duckdb and flowmaps</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ekotov.pro/spanish-open-mobility-workshop-ic2s2-2025/">Mobility Flows and Accessibility Using R and Big Open Data</a></li>
    <li><a class="external-link dropdown-item" href="https://tdscience.github.io/dstp/">Data Science for Transport Planning</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenSpain/spanishoddata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
    <div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quicky get daily data</h1>




      <small class="dont-index">Source: <a href="https://github.com/rOpenSpain/spanishoddata/blob/main/vignettes/quick-get.qmd" class="external-link"><code>vignettes/quick-get.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div>
<blockquote>
<p><strong>Warning</strong></p>
<p><strong>This functionality may stop working at any time, as the API may change unexpectedly.</strong></p>
</blockquote>
</div>
<section class="level2" data-number="1"><h2 data-number="1" id="intro">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This vignette demonstrates how to get minimal daily aggregated data on the number of trips between municipalities using the function. With this function, you only get total trips for a single day, and no additional variables that are available in the full <a href="v2-2022-onwards-mitma-data-codebook.html">v2 (2022 onwards) data set</a>. The advantage of this function is that it is much faster than downloading the full data from source CSV files using <code><a href="../reference/spod_get.html">spod_get()</a></code>, as each CSV file for a single day is about 200 MB in size. Also, this way of getting the data is much less demanding on your computer as you are only getting a small table from the internet (less than 1 MB), and no data processing (such as aggregation from more detailed hourly data with extra columns that is happening when you use <code><a href="../reference/spod_get.html">spod_get()</a></code> function) is required on your computer. The original interactive web map with this data is available at <a href="https://mapas-movilidad.transportes.gob.es/" target="_blank" class="external-link">https://mapas-movilidad.transportes.gob.es/</a>.</p>
</section><section class="level2" data-number="2"><h2 data-number="2" id="setup">
<span class="header-section-number">2</span> Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Make sure you have loaded the package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rOpenSpain.github.io/spanishoddata/">spanishoddata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2" data-number="3"><h2 data-number="3" id="set-data-folder">
<span class="header-section-number">3</span> Set the data directory<a class="anchor" aria-label="anchor" href="#set-data-folder"></a>
</h2>
<p>Choose where <a href="https://rOpenSpain.github.io/spanishoddata/">spanishoddata</a> should download (and convert) the data by setting the data directory following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spod_set_data_dir.html">spod_set_data_dir</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="st">"~/spanish_od_data"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The function above will also ensure that the directory is created and that you have sufficient permissions to write to it.</p>
<details><summary>
Setting data directory for advanced users
</summary><p>You can also set the data directory with an environment variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>SPANISH_OD_DATA_DIR <span class="op">=</span> <span class="st">"~/spanish_od_data"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The package will create this directory if it does not exist on the first run of any function that downloads the data.</p>
<p>To permanently set the directory for all projects, you can specify the data directory globally by setting the <code>SPANISH_OD_DATA_DIR</code> environment variable, e.g. with the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Then set the data directory globally, by typing this line in the file:</span></span></code></pre></div>
</div>
<pre><code><span><span class="va">SPANISH_OD_DATA_DIR</span> <span class="op">=</span> <span class="st">"~/spanish_od_data"</span></span></code></pre>
<p>You can also set the data directory locally, just for the current project. Set the ‘envar’ in the working directory by editing <code>.Renviron</code> file in the root of the project:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/file.edit.html" class="external-link">file.edit</a></span><span class="op">(</span><span class="st">".Renviron"</span><span class="op">)</span></span></code></pre></div>
</div>
</details><div>
<blockquote>
<p><strong>Note</strong></p>
<p>Setting a local data directory in this case is optional, as the data is downloaded directly from the web API and there is no caching on disk. However, the metadata will be downloaded to check the range of valid dates available at the time of the request. So metadata will be downloaded to a temporary location by default, or to the data directory, if you do set it.</p>
</blockquote>
</div>
</section><section class="level2" data-number="4"><h2 data-number="4" id="get-data">
<span class="header-section-number">4</span> Get the data<a class="anchor" aria-label="anchor" href="#get-data"></a>
</h2>
<section class="level3" data-number="4.1"><h3 data-number="4.1" id="get-all-flows-with-at-least-1000-trips">
<span class="header-section-number">4.1</span> Get all flows with at least 1000 trips<a class="anchor" aria-label="anchor" href="#get-all-flows-with-at-least-1000-trips"></a>
</h3>
<p>To get the data, use the function. There is no need to specify whether you need municipalities or districts, as the only municipal level data can be accessed with this function. The <code>min_trips</code> argument specifies the minimum number of trips to include in the data. If you set <code>min_trips</code> to 0, you will get all data for all origin-destination pairs for the specified date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">od_1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spod_quick_get_od.html">spod_quick_get_od</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  min_trips <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>The data is returned as a tibble and only contanes the requested date, the identifiers of the origin and destination municipalities, the number of trips, and the total length of trips in kilometers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">od_1000</span><span class="op">)</span></span></code></pre></div>
</div>
<pre><code>glimpse(od_1000)
Rows: 8,524
Columns: 5
$ date                  &lt;date&gt; 2022-01-01, 2022-01-01, 2022-01-01, 2022…
$ id_origin             &lt;chr&gt; "01001", "01002", "01002", "01002", "0100…
$ id_destination        &lt;chr&gt; "01059", "01036", "01002", "01054_AM", "0…
$ n_trips               &lt;int&gt; 2142, 1215, 8899, 1105, 2250, 4621, 1992,…
$ trips_total_length_km &lt;int&gt; 27130, 13743, 26700, 10603, 12228, 69999,…</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">od_1000</span></span></code></pre></div>
</div>
<pre><code># A tibble: 8,524 × 5
   date       id_origin id_destination n_trips trips_total_length_km
   &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;int&gt;                 &lt;int&gt;
 1 2022-01-01 01001     01059             2142                 27130
 2 2022-01-01 01002     01036             1215                 13743
 3 2022-01-01 01002     01002             8899                 26700
 4 2022-01-01 01002     01054_AM          1105                 10603
 5 2022-01-01 01002     01010             2250                 12228
 6 2022-01-01 01009_AM  01059             4621                 69999
 7 2022-01-01 01009_AM  01009_AM          1992                 16395
 8 2022-01-01 01009_AM  01051             2680                 18554
 9 2022-01-01 01010     01002             2147                 11578
10 2022-01-01 01017_AM  01017_AM          1847                 12695
# ℹ 8,514 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</section><section class="level3" data-number="4.2"><h3 data-number="4.2" id="get-only-trips-of-certain-length">
<span class="header-section-number">4.2</span> Get only trips of certain length<a class="anchor" aria-label="anchor" href="#get-only-trips-of-certain-length"></a>
</h3>
<p>To get only trips of a certain length, use the <code>distances</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">od_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spod_quick_get_od.html">spod_quick_get_od</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  min_trips <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  distances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10-50km"</span>, <span class="st">"50+km"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">od_long</span><span class="op">)</span></span></code></pre></div>
</div>
<pre><code>Rows: 247,208
Columns: 5
$ date                  &lt;date&gt; 2022-01-01, 2022-01-01, 2022-01-01, 2022…
$ id_origin             &lt;chr&gt; "08015", "08015", "08015", "08015", "0801…
$ id_destination        &lt;chr&gt; "08285", "17902_AM", "43014", "08007", "0…
$ n_trips               &lt;int&gt; 5, 1, 5, 165, 210, 111, 1486, 39, 52, 166…
$ trips_total_length_km &lt;int&gt; 339, 161, 924, 5052, 2955, 2453, 29630, 1…</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">od_long</span></span></code></pre></div>
</div>
<pre><code># A tibble: 247,208 × 5
   date       id_origin id_destination n_trips trips_total_length_km
   &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;int&gt;                 &lt;int&gt;
 1 2022-01-01 08015     08285                5                   339
 2 2022-01-01 08015     17902_AM             1                   161
 3 2022-01-01 08015     43014                5                   924
 4 2022-01-01 08015     08007              165                  5052
 5 2022-01-01 08015     08030              210                  2955
 6 2022-01-01 08015     08051              111                  2453
 7 2022-01-01 08015     08121             1486                 29630
 8 2022-01-01 08015     08122_AM            39                  1886
 9 2022-01-01 08015     08300_AM            52                  1301
10 2022-01-01 08015     08902              166                  2042
# ℹ 247,198 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</section><section class="level3" data-number="4.3"><h3 data-number="4.3" id="get-only-trips-between-certain-municipalities">
<span class="header-section-number">4.3</span> Get only trips between certain municipalities<a class="anchor" aria-label="anchor" href="#get-only-trips-between-certain-municipalities"></a>
</h3>
<p>To get only trips between certain municipalities, use the <code>id_origin</code> and <code>id_destination</code> arguments.</p>
<p>You can get all valid munincipality identifiers with the <code>spod_get_zones("muni", ver = 2)</code> function. This function will need to download some spatial data, so it might take some time and you might want to <a href="#setup">setup the data download folder</a> with <code>spod_setup_cache()</code> if you have not done so before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">municipalities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spod_quick_get_zones.html">spod_quick_get_zones</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if code above fails, you can also use the following:</span></span>
<span><span class="co"># municipalities &lt;- spod_get_zones("muni", ver = 2)</span></span>
<span><span class="co"># head(municipalities)</span></span></code></pre></div>
</div>
<section class="level4" data-number="4.3.1"><h4 data-number="4.3.1" id="all-trips-from-madrid">
<span class="header-section-number">4.3.1</span> All trips from Madrid<a class="anchor" aria-label="anchor" href="#all-trips-from-madrid"></a>
</h4>
<p>Let us select all locations with Madrid in the name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">madrid_muni_ids</span> <span class="op">&lt;-</span> <span class="va">municipalities</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"Madrid"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">madrid_muni_ids</span></span></code></pre></div>
</div>
<pre><code>[1] "28073" "28079" "28127" "45087"</code></pre>
<p>Now let use use these IDs as origins to gett all trips from Madrid to the rest of Spain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flows_from_Madrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spod_quick_get_od.html">spod_quick_get_od</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  min_trips <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  id_origin <span class="op">=</span> <span class="va">madrid_muni_ids</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">flows_from_Madrid</span><span class="op">)</span></span></code></pre></div>
</div>
<pre><code>Rows: 2,232
Columns: 5
$ date                  &lt;date&gt; 2022-01-01, 2022-01-01, 2022-01-01, 2022…
$ id_origin             &lt;chr&gt; "28073", "28073", "28073", "28073", "2807…
$ id_destination        &lt;chr&gt; "28007", "28066", "28079", "45081", "FR10…
$ n_trips               &lt;int&gt; 1239, 1505, 3730, 237, 2, 10, 11, 5, 9, 2…
$ trips_total_length_km &lt;int&gt; 11120, 7268, 75798, 3385, 82, 296, 1036, …</code></pre>
<pre><code># A tibble: 2,232 × 5
   date       id_origin id_destination n_trips trips_total_length_km
   &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;int&gt;                 &lt;int&gt;
 1 2022-01-01 28073     28007             1239                 11120
 2 2022-01-01 28073     28066             1505                  7268
 3 2022-01-01 28073     28079             3730                 75798
 4 2022-01-01 28073     45081              237                  3385
 5 2022-01-01 28073     FR102                2                    82
 6 2022-01-01 28073     28177               10                   296
 7 2022-01-01 28073     45165               11                  1036
 8 2022-01-01 28073     46011_AM             5                  1621
 9 2022-01-01 28073     21076_AM             9                  4102
10 2022-01-01 28073     46120_AM             2                   631
# ℹ 2,222 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</section><section class="level4" data-number="4.3.2"><h4 data-number="4.3.2" id="all-trips-from-madrid-to-barcelona">
<span class="header-section-number">4.3.2</span> All trips from Madrid to Barcelona<a class="anchor" aria-label="anchor" href="#all-trips-from-madrid-to-barcelona"></a>
</h4>
<p>Similarly, you can set limits on the destination municipalities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barcelona_muni_ids</span> <span class="op">&lt;-</span> <span class="va">municipalities</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"Barcelona"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">barcelona_muni_ids</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">madrid_barcelona_od</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spod_quick_get_od.html">spod_quick_get_od</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  min_trips <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  id_origin <span class="op">=</span> <span class="va">madrid_muni_ids</span>,</span>
<span>  id_destination <span class="op">=</span> <span class="va">barcelona_muni_ids</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">madrid_barcelona_od</span></span></code></pre></div>
</div>
<pre><code># A tibble: 4 × 5
  date       id_origin id_destination n_trips trips_total_length_km
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;int&gt;                 &lt;int&gt;
1 2022-01-01 28073     08019                2                  1334
2 2022-01-01 28079     08019             1661                838281
3 2022-01-01 28127     08019               26                 13699
4 2022-01-01 45087     08019                2                  1184</code></pre>
<p>You can now proceed to analyse these flows or visualise them as in the <a href="https://rOpenSpain.github.io/spanishoddata/articles/flowmaps-static.html">static</a> and <a href="https://rOpenSpain.github.io/spanishoddata/articles/flowmaps-interactive.html">interactive</a> flow maps tutorials.</p>
</section></section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>

  </div>

  <!-- ropenspain rostemplate -->
<footer id="footer"><div class="container">
    <div class="row">
      <div class="col-md">
        <h4 data-toc-skip>About <img src="../logo.png" alt="spanishoddata Logo" height="24"> spanishoddata</h4>
        <p>Developed by <a href="https://www.ekotov.pro" class="external-link">Egor Kotov</a>, <a href="https://www.robinlovelace.net/" class="external-link">Robin Lovelace</a>. <br>Part of the <span class="ROS-light">rOpenSpain</span> project.
</p>
        <hr class="d-md-none">
</div>
      <div class="col-md offset-md-4">
        <h4 data-toc-skip>About <img src="../ROS-logo.png" alt="ROpenSpain Logo" height="24"><span class="ROS-light"> rOpenSpain</span>
</h4>
        <p><a href="https://ropenspain.es/" class="external-link"><span class="ROS-light">rOpenSpain</span></a> is a community of enthusiasts
          of <strong>R</strong>, open data, and reproducibility that comes
          together and organizes itself to create <strong>R</strong> packages of the highest quality for the analysis
          and use of Spanish data of general interest.
        </p>
        <hr class="d-md-none">
</div>
    </div>
  </div>
</footer><div id="copyright">
  <div class="container">
    <div class="row">
      <div class="col-md text-center text-md-start">
        <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
      </div>
      <div class="col-md offset-md-4 text-center text-md-start lh-base">
        <p>Template <a href="https://github.com/ropenspain/rostemplate/" class="external-link">rostemplate</a> by <a href="https://github.com/dieghernan/" class="external-link">dieghernan</a>, based on <a href="https://devcows.github.io/hugo-universal-theme/" class="external-link">Universal
            Theme for Hugo</a>.
        </p>
      </div>
    </div>
  </div>
</div>




  <script>
  var h1s = document.getElementsByTagName("h1");
  var myH1;
  if (h1s.length > 0) {
    myH1 = h1s[0];
    myH1.classList.add("ROSh1");
  }
</script>
</body>
</html>
